---
layout: post
title: "배열로 구현한 스택(Stack)"
tags: ["Java", "Data Structure"]
comments: true
---

스택(`Stack`)은 가장 최근에 입력된 데이터가 가장 먼저 출력되는 후입선출(`Last In First Out`)의 대표적인 자료구조입니다. 오늘은 배열을 사용하여 스택을 구현해보도록 하겠습니다.

## Implementation

아래와 같이 `Stack` 클래스의 필드와 메소드를 정의합니다.

```java
public class Stack {
    private final int[] arr;
    private final int maxSize;
    private int topIndex = -1;

    public Stack(int maxSize);
    public boolean empty();
    public boolean full();
    public int size();
    public int top();
    public void push(int e);
    public int pop();
}
```

### Fields

| Name | Description |
|-|-|
| arr | 데이터를 저장할 배열 |
| maxSize | 스택의 최대 사이즈 |
| topIndex | 가장 최근에 입력된 데이터의 인덱스 |

### Constructor

배열의 크기는 정해져있기 때문에 스택을 생성할 때 생성자에서 `maxSize`를 인자로 받아 배열을 동적으로 할당해줍니다. `maxSize`는 스택이 가득차있는지 확인하는 척도가 됩니다.

```java
public Stack(int maxSize) {
    this.arr = new int[maxSize];
    this.maxSize = maxSize;
}
```

### empty()

`topIndex`는 가장 최근에 입력된 데이터의 인덱스를 가리키기 때문에 `-1`인지 확인해서 스택이 비어있는지 확인할 수 있습니다.

```java
public boolean empty() {
    return topIndex == -1;
}
```

### full()

`topIndex`는 가장 최근에 입력된 데이터의 인덱스를 가리키기 때문에 배열의 마지막 인덱스(`maxSize - 1`)와 같은지 확인하여 스택이 가득차있는지 확인할 수 있습니다.

```java
public boolean full() {
    return topIndex == maxSize - 1;
}
```

### size()

스택의 사이즈는 `topIndex + 1`과 같습니다.

```java
public int size() {
    return topIndex + 1;
}
```

### top()

`topIndex`를 사용하여 가장 최근에 입력된 데이터를 반환할 수 있습니다. 만약 스택이 비어있다면 예외 처리를 해줘야 합니다.

```java
public int top() {
    if (empty()) {
        throw new NoSuchElementException();
    }
    return arr[topIndex];
}
```

### push()

`topIndex`에 `1`을 더하여 스택에 데이터를 입력할 수 있습니다. 만약 스택이 가득차있다면 예외 처리를 해줘야 합니다.

```java
public void push(int e) {
    if (full()) {
        throw new IndexOutOfBoundsException();
    }
    arr[++topIndex] = e;
}
```

### pop()

`top()` 메서드를 통해 가장 최근에 입력된 데이터를 반환하고 `topIndex`의 값을 `1` 줄여줍니다. 만약 스택이 비어있다면 `top()` 메서드에서 예외 처리가 됩니다.

```java
public int pop() {
    int ret = top();// if empty, throw exception
    topIndex--;
    return ret;
}
```

## Time Complexity

`Stack` 클래스의 각 메서드의 시간 복잡도는 다음과 같습니다.

| Method | Time Complexity |
|:-:|:-:|
| empty() | O(1) |
| full() | O(1) |
| size() | O(1) |
| top() | O(1) |
| push() | O(1) |
| pop() | O(1) |

## Full Source Code

```java
public class Stack {
    private final int[] arr;
    private final int maxSize;
    private int topIndex = -1;

    public Stack(int maxSize) {
        this.arr = new int[maxSize];
        this.maxSize = maxSize;
    }

    public boolean empty() {
        return topIndex == -1;
    }

    public boolean full() {
        return topIndex == maxSize - 1;
    }

    public int size() {
        return topIndex + 1;
    }

    public int top() {
        if (empty()) {
            throw new NoSuchElementException();
        }
        return arr[topIndex];
    }

    public void push(int e) {
        if (full()) {
            throw new IndexOutOfBoundsException();
        }
        arr[++topIndex] = e;
    }

    public int pop() {
        int ret = top();// if empty, throw exception
        topIndex--;
        return ret;
    }
}
```
